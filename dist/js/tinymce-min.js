!function(e){const t={newdocument:"core",bold:"core",italic:"core",underline:"core",strikethrough:"core",alignleft:"core",aligncenter:"core",alignright:"core",alignjustify:"core",alignnone:"core",styleselect:"core",formatselect:"core",fontselect:"core",fontsizeselect:"core",cut:"core",copy:"core",paste:"core",outdent:"core",indent:"core",blockquote:"core",undo:"core",redo:"core",removeformat:"core",subscript:"core",superscript:"core",visualaid:"core",insert:"core",hr:"hr",bullist:"lists",numlist:"lists",link:"link",unlink:"link",openlink:"link",image:"image",charmap:"charmap",pastetext:"paste",print:"print",preview:"preview",anchor:"anchor",pagebreak:"pagebreak",spellchecker:"spellchecker",searchreplace:"searchreplace",visualblocks:"visualblocks",visualchars:"visualchars",code:"code",help:"help",fullscreen:"fullscreen",insertdatetime:"insertdatetime",media:"media",nonbreaking:"nonbreaking",save:"save",cancel:"save",table:"table",tabledelete:"table",tablecellprops:"table",tablemergecells:"table",tablesplitcells:"table",tableinsertrowbefore:"table",tableinsertrowafter:"table",tabledeleterow:"table",tablerowprops:"table",tablecutrow:"table",tablecopyrow:"table",tablepasterowbefore:"table",tablepasterowafter:"table",tableinsertcolbefore:"table",tableinsertcolafter:"table",tabledeletecol:"table",rotateleft:"imagetools",rotateright:"imagetools",flipv:"imagetools",fliph:"imagetools",editimage:"imagetools",imageoptions:"imagetools",fullpage:"fullpage",ltr:"directionality",rtl:"directionality",emoticons:"emoticons",template:"template",forecolor:"textcolor",backcolor:"textcolor",toc:"toc"};let l,i;Mavo.Plugins.register("tinymce",{ready:e.include(self.tinymce,"https://cdnjs.cloudflare.com/ajax/libs/tinymce/4.9.11/tinymce.min.js").then((()=>{l=new tinymce.html.DomParser,i=new tinymce.html.Serializer}))}),Mavo.Elements.register(".tinymce",{hasChildren:!0,default:!0,edit:function(){(this.preEdit||Promise.resolve()).then((e=>{if("abort"===e)return;if(this.element.tinymce)return void tinymce.EditorManager.execCommand("mceAddEditor",!0,this.element.tinymce.id);const l=this.element.getAttribute("mv-tinymce-toolbar")?.trim()||"styleselect | bold italic | image link | table | bullist numlist",i=l.split("|").filter((e=>e.length)).join(" ").split(/\s+/),o=new Set;o.add("tabfocus"),i.forEach((e=>{const l=t[e];l?o.add(l):Mavo.warn(`Button with the name "${e}" can't be added to the toolbar since it is not supported by the TinyMCE plugin.`)})),o.delete("core"),tinymce.init({target:this.element,inline:!0,menubar:!1,toolbar:l,plugins:Array.from(o).join(" ")}).then((e=>{this.element.tinymce=e[0],this.element.tinymce.on("change keyup paste cut",(e=>{this.value=this.getValue()}))}))}))},done:function(){this.element.tinymce&&tinymce.EditorManager.execCommand("mceRemoveEditor",!0,this.element.tinymce.id)},getValue:e=>e.tinymce?e.tinymce.getContent():e.innerHTML,setValue:(e,t)=>{const o=i.serialize(l.parse(t));e.tinymce?e.tinymce.isHidden()&&e.tinymce.setContent(o):e.innerHTML=o}})}(Bliss);